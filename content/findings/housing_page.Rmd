---
title: "Housing"
description: "What kinds of affordable housing options exist?"
tags: ["R", "Visualization"]
weight: 3
draft: false
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 20, fig.height = 10)

library(here)
library(dplyr)
library(stringr)
library(ggplot2)
library(gghighlight)
library(tidyr)
library(leaflet)
library(sf)

theme_set(theme_minimal() + 
            theme(plot.title = element_text(hjust = 0.5, color = "gray10", size = 22), 
                  plot.subtitle = element_text(hjust = 0.5, color = "gray30", face = "italic", size = 18),
                  axis.title = element_text(size = 18, color = "gray10"),
                  axis.text = element_text(size = 16, color = "gray30"),
                  strip.text = element_text(size = 20, color = "gray30"),
                  panel.spacing = unit(4, "lines"),
                  legend.key.size = unit(3, "line"),
                  legend.text = element_text(size = 14, color = "gray30"),
                  legend.title = element_text(size = 20, color = "gray10")))

## Read in all public housing data and clean county strings
pub_housing_summary <- vroom::vroom(here("data", "original", "Housing", "county_pub_housing_2013_2019.csv")) %>%
  replace("NA", NA) %>%
  mutate(across(everything(), function(col) ifelse(col == -1 | col == -4 | col == -5, NA, col))) %>% ## -1 = NA, -4 = Suppressed, -5 = % reporting too low
  mutate(name = str_extract(str_replace_all(str_to_lower(name), "[0-9]{3} ", ""), "^([^,])+"), ## County names have numbers for some years, include state name after a comma for some years. Clean these
         name = str_to_title(trimws(ifelse(str_detect(name, "city county"), str_replace_all(name, "county", ""), name)))) ## Clean duplicated counties that are labeled as both city and county

## Vera incarceration data
vera_data <- data.table::fread(here::here("data", "original", "Incarceration", "vera_incarceration_trends.csv")) %>% 
  as.data.frame() %>%
  mutate(fips = as.character(fips))

## Subset to overall HUD summary data
va_pub_housing <- pub_housing_summary %>%
  filter(program_label == "Summary of All HUD Programs", state == "VA")

halifax_pub_housing <- va_pub_housing %>% filter(code == "51083")

## Join on incarceration data for recent years
va_housing_vera <- vera_data %>%
  filter(state == "VA", year > 2011) %>%
  full_join(va_pub_housing, by = c("fips" = "code", "year" = "year"))
```

### Background

Despite being previously overshadowed in the literature, housing affordability has recently begun to situate itself at the center of efforts to transition incarcerated people back into the community after release. Many now see access to affordable housing as one of the primary limiting factors for reentering individuals; an unstable living situation can severely impact employment opportunities, predispose individuals to returning to criminal activity, and hinder efforts to reestablish family relationships and friendships[^1].

Housing thus enters the ecological model at multiple levels: at the policy level, eligibility for low-income housing opportunities may be limited by prior convictions (despite HUD recommendations to the contrary)[^2]. At the community level, affordable housing locations can impact an individual’s access to other services that they may need, including substance abuse treatment, education, and employment opportunities. And at the relationship level, housing can serve as either a platform for successful reintegration by allowing for the re-establishment of family connections (or can present a challenge when these relationships are already frayed)[^3].

To assess housing affordability in Halifax County, we relied on multiple datasets curated by the Department of Housing and Urban Development (HUD). HUD maintains datasets on low-income housing tax credit funding, characteristics of individuals living in federally subsidized housing, and administrative data used to calculate income limits for subsidized housing. While these datasets provide a picture of housing affordability in an area, they do not focus explicitly on the formerly incarcerated population, and often don’t address the unique challenges these individuals have accessing these housing opportunities.

### Main Findings

As of 2019, the Department of Housing and Urban development lists a total of 171 units across 9 official properties in Halifax County designed to support low-income individuals. The relative income distribution of those living in HUD subsidized housing has been shifting upwards in recent years, and extremely low income individuals and families make up a slightly smaller proportion of the subsidized housing population. These patterns are in keeping with the patterns followed by many other Virginia counties between 2012 and 2019.

```{r}
knitr::kable(halifax_pub_housing %>% select(year, pct_lt5k , pct_5k_lt10k, pct_10k_lt15k, pct_15k_lt20k, pct_ge20k, pct_lt50_median, pct_lt30_median), "pipe")

# va_pub_housing %>% ggplot() + geom_line(aes(x = year, y = pct_lt30_median, group = name)) + gghighlight(code == "51083")
```

```{r}
#va_pub_housing %>% ggplot() + geom_point(aes(x = name, y = pct_lt30_median))
```

However, while the general income distribution is typical, Halifax does stand out when it comes to the demographic makeup of its subsidized housing population. In particular, the population is composed almost exclusively non-hispanic black, and contains a disproportionate number of single adults with children. In addition, many of these family units are headed by someone (often the mother) younger than 24. These patterns are summarized in the following scatter plot:


```{r}
## Pct of households headed by a single parent (most are females in Halifax - can show)
va_data <- pub_housing_summary %>%
  filter(year == 2019, program_label %in% c("Housing Choice Vouchers", "Project Based Section 8")) %>%
  mutate(isVA = ifelse(state == "VA", TRUE, FALSE),
         isHalifax = ifelse(state == "VA" & name == "Halifax County", TRUE, FALSE),
         pct_lt24_head = ifelse(is.na(pct_lt24_head), 100 - pct_age25_50 - pct_age51_61 - pct_age62plus, pct_lt24_head)) %>%
  filter(isVA == TRUE)

us_data <- pub_housing_summary %>%
  filter(year == 2019, program_label %in% c("Housing Choice Vouchers", "Project Based Section 8")) %>%
  mutate(isVA = ifelse(state == "VA", TRUE, FALSE),
         isHalifax = ifelse(state == "VA" & name == "Halifax County", TRUE, FALSE),
         pct_lt24_head = ifelse(is.na(pct_lt24_head), 100 - pct_age25_50 - pct_age51_61 - pct_age62plus, pct_lt24_head)) %>%
  filter(isVA == FALSE)

plot <- ggplot() +
  geom_point(data = us_data, aes(x = pct_black_nonhsp, y = pct_1adult, color = interaction(isVA, isHalifax), size = pct_lt24_head, alpha = isVA), stroke = 1.25) +
  geom_point(data = va_data, aes(x = pct_black_nonhsp, y = pct_1adult, color = interaction(isVA, isHalifax), size = pct_lt24_head, alpha = isVA), stroke = 1.25) +
  coord_flip() +
  scale_size_continuous(range = c(0, 20), labels = c("0%", "10%", "20%", "30%", "40%")) +
  scale_color_manual(labels = c("U.S.", "Virginia", "Halifax County"), values = c("#e4e0cd", "#6b6385", "#FC4444"), na.translate=FALSE) +
  labs(y = "\nPercent Single Adults with Children", x = "Percent Black (Non-Hispanic)\n", 
       title = "Characteristics of Subsidized Housing Population", 
       size = "Houshold heads less \nthan 24 years old") +
  guides(alpha = FALSE, color = guide_legend(title = "Locale", override.aes = list(size=10)), size = guide_legend(override.aes = list(shape = 21, alpha = 0.8))) +
  scale_alpha_manual(values = c(0.3, 0.8)) +
  facet_wrap(~program_label, ncol = 2)

plot
```

These characteristics are notable when considered in the context of incarceration because they highlight a distinctly vulnerable population in Halifax County. Research unsurprisingly corroborates the intuition that low levels of family supervision are related to higher rates of juvenile delinquency in adolescents [^4]. The children of single parents, particularly those also experiencing financial strain, are thus at heightened risk of delinquent behavior, putting them at increased risk of encounters with law enforcement. Over time, these encounters may predispose these individuals to heightened risk of spending time in the criminal justice system. When these individuals are thus absent from family life themselves, the potential exists for the cycle to repeat itself.

Also of note in this plot is the overall difference in the ages of heads-of-households across the two common subsidized housing types in the county. Families headed by younger adults are more likely to live in project-based housing.

While nothing about these patterns suggests any relationship to incarceration trends in the county, they do suggest a population that could benefit from community programs tailored specifically to its particular needs.

------

Of course, a key question when considering the ability of federally subsidized housing to help address issues of recidivism and incarceration is whether the subsidized housing system has the capacity to serve as a resource to formerly incarcerated individuals as they re-enter society.

The subsidized housing system obviously serves a broad population beyond those with criminal records, and is routinely backlogged with long wait lists regardless. Still, it is a valuable point of reference to consider the overall subsidized housing stock relative to the incarcerated population in a given area.

Below, we display the size of the annual number of jail discharges relative to the overall subsidized housing capacity, with Halifax County highlighted. Very few Virginia counties have a general subsidized housing supply on par with the annual discharge rate, and while Halifax is by no means an outlier, it still discharges roughly three times the number of individuals from jail as people in its subsidized housing system. While many of these individuals will find housing elsewhere, this finding speaks to the limitations of considering the federally subsidized housing as a sole option to help re-integrate these individuals affordably and effectively.

```{r, fig.width = 15, fig.height = 10}
## Relative plot
va_housing_vera %>%
  filter(year == 2017, !is.na(people_total), !is.na(total_jail_dis)) %>%
  mutate(isHalifax = ifelse(fips == "51083", "yes", "no"), 
         #capacity = 1 / (people_total / ((100 - pct_occupied) / 100)),
         capacity_color = ifelse(total_jail_dis > people_total, "above", "below"), 
         diff = total_jail_dis / people_total) %>%
  ggplot() +
  geom_segment(aes(x = reorder(fips,diff), xend = reorder(fips,diff), yend = 1, y = diff, alpha = isHalifax, color = capacity_color), size = 2) +
  geom_point(aes(x = reorder(fips,-diff), y = diff, alpha = isHalifax, color = capacity_color), size = 2) +
  #geom_point(aes(x = reorder(fips,-people_total), y = people_total, alpha = isHalifax, color = capacity), size = 0.75) +
  scale_alpha_manual(values = c(0.2, 1)) +
  scale_color_manual(values = c("#FC4444","#6b6385")) +
  scale_y_continuous(breaks = c(1, 5, 10, 25, 50)) +
  labs(x = "County", y = "Size of Jail Discharge Population \nRelative to Subsidized Housing Capacity", title = "Capacity of Subsidized Housing System") +
  theme_update(panel.grid.minor = element_blank(),
               panel.grid.major.x = element_blank(),
               axis.text.x = element_blank(),
               legend.position = "none")
```

Identifying and connecting individuals with other affordable housing options may therefore be a valuable role for a potential Family and Consumer Science Agent in the county. Similarly, motivating the community to consider alternative options for developing a robust affordable housing stock may be warranted, and bringing private landlords into the discussion may be an important component of a successful strategy.


### Conclusion and Policy Implications 

_Maybe should move some of the above discussion to this section?_

- More Data if we could have it:

- Data on community NIMBY attitudes
- Data on removals from subsidized housing. Data on removals from private housings. Answer question: do formerly incarcerated individuals pose undue risk to these areas?


### References 

[^1]: Fontaine, J. (2013). Examining housing as a pathway to successful reentry: A demonstration design process. Washington, DC: Urban Institute.

[^2]: Gaitan, V., & Brennan, M. (2020). For Reentry Success and Beyond, Rental Housing Access Matters. Retrieved from https://housingmatters.urban.org/articles/reentry-success-and-beyond-rental-housing-access-matters

[^3]: Fontaine, J., & Biess, J. (2012). Housing as a platform for formerly incarcerated persons. Washington, DC: Urban Institute.

[^4]: Lynskey, D. P., Winfree Jr, L. T., Esbensen, F. A., & Clason, D. L. (2000). Linking gender, minority group status and family matters to self‐control theory: A multivariate analysis of key self‐control concepts in a youth‐gang context. Juvenile and Family Court Journal, 51(3), 1-19.


